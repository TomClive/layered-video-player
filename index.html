<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eidolon Interface V5 (Clean / No Filters)</title>
    <style>
        /* RESET & LAYOUT */
        body { 
            background: #000; 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Courier New', Courier, monospace;
        }

        #stage {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain; 
        }

        /* PRIMARY LAYER (Bottom) */
        #vid-primary { 
            z-index: 10; 
            opacity: 1;
        }
        
        /* GHOST LAYER (Top) */
        #vid-ghost { 
            z-index: 20; 
            opacity: 0; 
            pointer-events: none;
            
            /* Slow Fade for Play/Pause (Cinematic) */
            /* Removed the 'filter' transition */
            transition: opacity 1.5s ease-in-out;
        }

        /* FAST TRANSITION CLASS (For Scrubbing) */
        .scrubbing-mode {
            /* Makes the ghost appear instantly when dragging */
            transition: opacity 0.15s ease-out !important;
            
            /* FILTERS REMOVED: Now relies purely on the video file's look */
        }

        /* UI OVERLAY */
        #ui-layer {
            position: absolute;
            bottom: 30px;
            left: 5%;
            width: 90%;
            z-index: 100;
            background: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(5px);
            border: 1px solid #333;
        }

        .controls-row {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        input[type=range] {
            flex-grow: 1;
            cursor: pointer;
            height: 5px;
            accent-color: #ff0044;
        }

        button {
            background: #eee;
            color: #000;
            border: none;
            padding: 8px 16px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }
        button:hover { background: #fff; }

        #status-text {
            color: #ff0044;
            font-size: 12px;
            margin-top: 5px;
            text-align: right;
        }

        #error-msg {
            display: none;
            color: red;
            background: black;
            padding: 10px;
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 200;
            border: 1px solid red;
        }

    </style>
</head>
<body>

    <div id="error-msg"></div>

    <div id="stage">
        <!-- GHOST (Top Layer) -->
        <video id="vid-ghost" muted playsinline preload="auto"></video>
        <!-- PRIMARY (Bottom Layer) -->
        <video id="vid-primary" muted playsinline preload="auto"></video>
    </div>

    <div id="ui-layer">
        <div class="controls-row">
            <button id="play-btn">PLAY</button>
            <input type="range" id="scrubber" min="0" value="0" step="0.01">
        </div>
        <div id="status-text">INITIALIZING...</div>
    </div>

    <script>
        // ==========================================
        // 1. CONFIGURATION
        // ==========================================
        const CONFIG = {
            primary: "VideoLayer.mp4",  // Clean version
            ghost: "GhostLayer.mp4"     // Grimy/Treated version
        };

        // ==========================================
        // 2. ENGINE
        // ==========================================
        const primary = document.getElementById('vid-primary');
        const ghost = document.getElementById('vid-ghost');
        const scrubber = document.getElementById('scrubber');
        const playBtn = document.getElementById('play-btn');
        const status = document.getElementById('status-text');
        const errorMsg = document.getElementById('error-msg');

        let isUserScrubbing = false;

        // LOAD FROM CONFIG
        primary.src = CONFIG.primary;
        ghost.src = CONFIG.ghost;

        // ERROR HANDLING
        function reportError(e) {
            errorMsg.style.display = 'block';
            errorMsg.innerText = "ERROR: Could not load " + e.target.src;
        }
        primary.addEventListener('error', reportError);
        ghost.addEventListener('error', reportError);

        // INITIALIZATION
        primary.addEventListener('loadedmetadata', () => {
            scrubber.max = primary.duration;
            status.innerText = "READY // LINEAR MODE";
        });

        // SYNC LOOP
        primary.addEventListener('timeupdate', () => {
            if(!isUserScrubbing) {
                scrubber.value = primary.currentTime;
                
                // Keep sync tight
                if (Math.abs(primary.currentTime - ghost.currentTime) > 0.3) {
                    ghost.currentTime = primary.currentTime;
                }
            }
        });

        // PLAY / PAUSE LOGIC (The Slow Fade)
        playBtn.addEventListener('click', () => {
            // Remove scrubbing class so slow fade applies
            ghost.classList.remove('scrubbing-mode');

            if (primary.paused) {
                // PLAYING -> Fade Ghost Out
                primary.play();
                ghost.play();
                ghost.style.opacity = 0; 
                
                playBtn.innerText = "PAUSE";
                status.innerText = "PLAYING // EIDOLON LAYER";
            } else {
                // PAUSING -> Fade Ghost In Slowly (50%)
                primary.pause();
                ghost.pause();
                ghost.style.opacity = 0.5; 
                
                playBtn.innerText = "PLAY";
                status.innerText = "PAUSED // REALITY BLEED";
            }
        });

        // SCRUBBER INPUT (The Fast Reveal)
        scrubber.addEventListener('input', () => {
            isUserScrubbing = true;
            
            // Add class for Instant Transition
            ghost.classList.add('scrubbing-mode');
            
            primary.pause();
            ghost.pause();
            playBtn.innerText = "PLAY";

            // Update Time
            primary.currentTime = scrubber.value;
            ghost.currentTime = scrubber.value;

            // Show Ghost Strongly (80%)
            ghost.style.opacity = 0.8;
            
            status.innerText = "SCRUBBING // GHOST ACTIVE";
        });

        // SCRUBBER RELEASE (The Slow Settle)
        scrubber.addEventListener('change', () => {
            isUserScrubbing = false;
            
            // Remove fast class -> Settle back to slow fade
            ghost.classList.remove('scrubbing-mode');
            
            // Settle at 50% opacity (Paused State)
            ghost.style.opacity = 0.5;
            
            status.innerText = "HELD // CHECKING LAYERS";
        });

    </script>
</body>
</html>
